<!DOCTYPE html><html lang="en" ><head> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2093656452178150" crossorigin="anonymous"></script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.1" /><meta property="og:title" content="K8s PodAntiAffinity로 Pod의 중복 배포를 최소화 하기" /><meta name="author" content="garit" /><meta property="og:locale" content="en" /><meta name="description" content="K8s PodAntiAffinity로 Pod의 중복 배포를 최소화 하기" /><meta property="og:description" content="K8s PodAntiAffinity로 Pod의 중복 배포를 최소화 하기" /><link rel="canonical" href="https://ga0-lee.github.io/posts/k8s-pod-anti-affinity/" /><meta property="og:url" content="https://ga0-lee.github.io/posts/k8s-pod-anti-affinity/" /><meta property="og:site_name" content="Garit!" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-11-19T12:40:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="K8s PodAntiAffinity로 Pod의 중복 배포를 최소화 하기" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"garit"},"dateModified":"2022-12-13T19:30:51+09:00","datePublished":"2022-11-19T12:40:00+09:00","description":"K8s PodAntiAffinity로 Pod의 중복 배포를 최소화 하기","headline":"K8s PodAntiAffinity로 Pod의 중복 배포를 최소화 하기","mainEntityOfPage":{"@type":"WebPage","@id":"https://ga0-lee.github.io/posts/k8s-pod-anti-affinity/"},"url":"https://ga0-lee.github.io/posts/k8s-pod-anti-affinity/"}</script><title>K8s PodAntiAffinity로 Pod의 중복 배포를 최소화 하기 | Garit!</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Garit!"><meta name="application-name" content="Garit!"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://raw.githubusercontent.com/cotes2020/chirpy-images/main/commons/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Garit!</a></div><div class="site-subtitle font-italic">Record what I understand of</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/ga0-lee" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['lleun8956','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>K8s PodAntiAffinity로 Pod의 중복 배포를 최소화 하기</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>K8s PodAntiAffinity로 Pod의 중복 배포를 최소화 하기</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1668829200" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Nov 19, 2022 </em> </span> <span> Updated <em class="" data-ts="1670927451" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Dec 13, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> ga0-lee </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="774 words"> <em>4 min</em> read</span></div></div></div><div class="post-content"><h2 id="k8s-podantiaffinity로-pod의-중복-배포를-최소화-하기"><span class="mr-2">K8s PodAntiAffinity로 Pod의 중복 배포를 최소화 하기</span><a href="#k8s-podantiaffinity로-pod의-중복-배포를-최소화-하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="상황"><span class="mr-2">상황</span><a href="#상황" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>생성된 Worker Node가 3개, Pod의 최소 replica 수도 3개인데 어떤 Deployment는 하나의 노드에 3개의 Pod가 전부 배포되어 있고, 어떤 Deployment는 1,2번에만 pod가 배포되어 있는 걸 발견했다.<br /> <br /> 이런 경우 어느 노드 또는 가용영역에 장애가 발생하게 되면 순간적으로 서비스 중단이 될 수 있기에 각 노드에 Pod가 골고루 배포되도록 설정할 필요가 있다.<br /> <br /></p><h3 id="해결방안"><span class="mr-2">해결방안</span><a href="#해결방안" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><strong>PodAntiAffinity를 사용하여 이미 같은 Deployment의 Pod가 배포된 노드에는 중복 배포가 되지 않도록 설정한다.</strong><br /> <br /></p><p>podAntiAffinity 규칙은 스케줄러로 하여금 app=test 레이블을 가진 복수 개의 레플리카를 단일 노드에 배치하지 않게 한다. 이렇게 하여 Pod를 각 노드에 분산하여 생성한다.<br /> <br /></p><p>affinity.podAntiAffinity.preferredDuringSchedulingIgnoredDuringExecution.weight 값에 따라 어느 Node에 배포할지 가중치를 줄 수 있다.<br /> <br /></p><p>예를 들어 preferredDuringSchedulingIgnoredDuringExecution 규칙을 만족하는 노드가 2개 있고, 하나에는 app: test 레이블이 있고 다른 하나에는 type: nginx 레이블이 있으면, 스케줄러는 각 노드의 weight를 확인한 뒤 weight가 더 작은 쪽에 Pod를 배포한다.<br /> <br /></p><p>즉, app: test 레이블을 가진 pod-A가 배포된 node-A와 type: nginx 레이블을 가진 pod-B가 배포된 node-B가 있을 때 아래의 test-deploy는 가중치가 더 작은 app: test 레이블을 가진 pod-A가 배포된 node-A에 배포된다.<br /> <br /></p><p>또한 podAntiAffinity에서는 노드에 일관된 레이블을 지정해야 한다.<br /> <br /></p><p>즉, 클러스터의 모든 노드는 topologyKey 와 매칭되는 적절한 레이블을 가지고 있어야 한다. 일부 또는 모든 노드에 지정된 topologyKey 레이블이 없는 경우에는 의도하지 않은 동작이 발생할 수 있다.<br /> <br /></p><ul><li>예시</ul><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
</pre><td class="rouge-code"><pre><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">apps/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Deployment</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">labels</span><span class="pi">:</span>
    <span class="na">app</span><span class="pi">:</span> <span class="s">test</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">test-deploy</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">test-ns</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">replicas</span><span class="pi">:</span> <span class="m">1</span>
  <span class="na">selector</span><span class="pi">:</span>
    <span class="na">matchLabels</span><span class="pi">:</span>
      <span class="na">app</span><span class="pi">:</span> <span class="s">test</span>
  <span class="na">strategy</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">RollingUpdate</span>
  <span class="na">template</span><span class="pi">:</span>
    <span class="na">metadata</span><span class="pi">:</span>
      <span class="na">labels</span><span class="pi">:</span>
        <span class="na">app</span><span class="pi">:</span> <span class="s">test</span>
    <span class="na">spec</span><span class="pi">:</span>
      <span class="na">affinity</span><span class="pi">:</span>
        <span class="na">podAntiAffinity</span><span class="pi">:</span>
          <span class="na">preferredDuringSchedulingIgnoredDuringExecution</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">weight</span><span class="pi">:</span> <span class="m">10</span>
            <span class="na">podAffinityTerm</span><span class="pi">:</span>
              <span class="na">labelSelector</span><span class="pi">:</span>
                <span class="na">matchExpressions</span><span class="pi">:</span>
                <span class="pi">-</span> <span class="na">key</span><span class="pi">:</span> <span class="s">app</span>
                  <span class="na">operator</span><span class="pi">:</span> <span class="s">In</span>
                  <span class="na">values</span><span class="pi">:</span>
                  <span class="pi">-</span> <span class="s">test</span><span class="err">		</span>
              <span class="na">topologyKey</span><span class="pi">:</span> <span class="s2">"</span><span class="s">kubernetes.io/hostname"</span>                  
          <span class="pi">-</span> <span class="na">weight</span><span class="pi">:</span> <span class="m">50</span>
            <span class="na">podAffinityTerm</span><span class="pi">:</span>
              <span class="na">labelSelector</span><span class="pi">:</span>
                <span class="na">matchExpressions</span><span class="pi">:</span>
                <span class="pi">-</span> <span class="na">key</span><span class="pi">:</span> <span class="s">type</span>
                  <span class="na">operator</span><span class="pi">:</span> <span class="s">In</span>
                  <span class="na">values</span><span class="pi">:</span>
                  <span class="pi">-</span> <span class="s">nginx</span><span class="err">				</span>  
              <span class="na">topologyKey</span><span class="pi">:</span> <span class="s2">"</span><span class="s">kubernetes.io/hostname"</span>
      <span class="na">containers</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">image</span><span class="pi">:</span> <span class="s">123123123.dkr.ecr.ap-northeast-2.amazonaws.com/test:0.1.1</span>
        <span class="na">imagePullPolicy</span><span class="pi">:</span> <span class="s">Always</span>
        <span class="na">name</span><span class="pi">:</span> <span class="s">test-container</span>
        <span class="na">ports</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">containerPort</span><span class="pi">:</span> <span class="m">8080</span>
          <span class="na">name</span><span class="pi">:</span> <span class="s">p-8080</span>
        <span class="na">envFrom</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">configMapRef</span><span class="pi">:</span>
            <span class="na">name</span><span class="pi">:</span> <span class="s">test-configmap</span>
        <span class="na">resources</span><span class="pi">:</span>
          <span class="na">requests</span><span class="pi">:</span>
            <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1G"</span>
            <span class="na">cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1"</span>
          <span class="na">limits</span><span class="pi">:</span>
            <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1G"</span>
            <span class="na">cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1"</span>
        <span class="na">livenessProbe</span><span class="pi">:</span>
          <span class="na">tcpSocket</span><span class="pi">:</span>
            <span class="na">port</span><span class="pi">:</span> <span class="m">8080</span>
          <span class="na">initialDelaySeconds</span><span class="pi">:</span> <span class="m">30</span>
          <span class="na">periodSeconds</span><span class="pi">:</span> <span class="m">60</span>
        <span class="na">readinessProbe</span><span class="pi">:</span>
          <span class="na">tcpSocket</span><span class="pi">:</span>
            <span class="na">port</span><span class="pi">:</span> <span class="m">8080</span>
          <span class="na">initialDelaySeconds</span><span class="pi">:</span> <span class="m">30</span>
          <span class="na">periodSeconds</span><span class="pi">:</span> <span class="m">60</span>

</pre></table></code></div></div><p><br /></p><ul><li>주의: PodAffinity와 PodAntiAffinity에는 상당한 양의 프로세싱이 필요하기에 대규모 클러스터에서는 스케줄링 속도가 크게 느려질 수 있다. 수백 개의 노드를 넘어가는 클러스터에서 이를 사용하는 것은 추천하지 않는다.<br /> <br /></ul><p><br /><br /></p><p>참고</p><ul><li><a href="https://kubernetes.io/ko/docs/concepts/scheduling-eviction/assign-pod-node/#more-practical-use-cases">https://kubernetes.io/ko/docs/concepts/scheduling-eviction/assign-pod-node/#more-practical-use-cases</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/kubernetes/'>Kubernetes</a>, <a href='/categories/cases/'>Cases</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/k8s/" class="post-tag no-text-decoration" >k8s</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=K8s+PodAntiAffinity%EB%A1%9C+Pod%EC%9D%98+%EC%A4%91%EB%B3%B5+%EB%B0%B0%ED%8F%AC%EB%A5%BC+%EC%B5%9C%EC%86%8C%ED%99%94+%ED%95%98%EA%B8%B0+-+Garit%21&url=https%3A%2F%2Fga0-lee.github.io%2Fposts%2Fk8s-pod-anti-affinity%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=K8s+PodAntiAffinity%EB%A1%9C+Pod%EC%9D%98+%EC%A4%91%EB%B3%B5+%EB%B0%B0%ED%8F%AC%EB%A5%BC+%EC%B5%9C%EC%86%8C%ED%99%94+%ED%95%98%EA%B8%B0+-+Garit%21&u=https%3A%2F%2Fga0-lee.github.io%2Fposts%2Fk8s-pod-anti-affinity%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fga0-lee.github.io%2Fposts%2Fk8s-pod-anti-affinity%2F&text=K8s+PodAntiAffinity%EB%A1%9C+Pod%EC%9D%98+%EC%A4%91%EB%B3%B5+%EB%B0%B0%ED%8F%AC%EB%A5%BC+%EC%B5%9C%EC%86%8C%ED%99%94+%ED%95%98%EA%B8%B0+-+Garit%21" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/k8s-cp-ownership-error/">kubectl cp 명령어 ownership 에러 해결하기</a><li><a href="/posts/k8s-dashboard/">EKS에 Kubernetes Dashboard 배포하기</a><li><a href="/posts/k8s-java-heap-setting/">Java 기반 Pod에 Heap Memory 설정하기</a><li><a href="/posts/vim-backup-error/">vim 에러 Cannot create backup file(add ! to overwrite) 해결하기</a><li><a href="/posts/k8s-image-pull-error/">K8s Pod 이미지 Pull 에러 해결방안</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/k8s/">k8s</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/eks/">eks</a> <a class="post-tag" href="/tags/terraform/">terraform</a> <a class="post-tag" href="/tags/iac/">iac</a> <a class="post-tag" href="/tags/nginx/">nginx</a> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/argocd/">ArgoCD</a> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/docker/">docker</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/k8s-pod-tz-setting/"><div class="card-body"> <em class="small" data-ts="1668911400" data-df="ll" > Nov 20, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>K8s Pod에 Time Zone 설정하기</h3><div class="text-muted small"><p> K8s Pod에 Time Zone 설정하기 상황 생성된 Pod의 로그를 kubectl logs 명령어로 확인하면 로그가 찍히는 시간이 현재 시간과 달라 에러를 디버깅할 때 어려움이 생겼다. 그래서 Pod에 접속하여 /etc/localtime 을 확인해보니 UTC로 되어있었다. 해결방안 Pod에 Time Zone을 설정해서 한국 표준 시간으로 ...</p></div></div></a></div><div class="card"> <a href="/posts/k8s-java-heap-setting/"><div class="card-body"> <em class="small" data-ts="1668992400" data-df="ll" > Nov 21, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Java 기반 Pod에 Heap Memory 설정하기</h3><div class="text-muted small"><p> Java 기반 Pod에 Heap Memory 설정하기 상황 성능테스트를 하던 도중 원하는 목표치에 도달하기도 전에 OOM(Out of Memory) 에러가 발생하여 Java 기반의 Pod의 Heap 사이즈를 변경해달라는 요청을 받아 변경하려 한다. 해결 방법 아래와 같이 java 실행 명령어에 HEAP_OPT 값을 주어 app.jar를 실행시...</p></div></div></a></div><div class="card"> <a href="/posts/k8s-oom-heap-dump/"><div class="card-body"> <em class="small" data-ts="1669255200" data-df="ll" > Nov 24, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Java Pod에 OOM 발생시 Heap Dump 생성하는 설정하기</h3><div class="text-muted small"><p> Java Pod에 OOM 발생시 Heap Dump 생성하는 설정하기 상황 Java 기반의 Pod가 OOM이 발생하여 재생성 되었는데 이유가 무엇인지 확인할 수 없어 OOM killed 되었을 때 Heap Dump를 생성하는 옵션을 설정하고자 한다. 설정 방법 Pod 및 ConfigMap 설정 1 2 3 4 5 6 7 8 9 10 11...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/eks-autoscaling-setting/" class="btn btn-outline-primary" prompt="Older"><p>EKS Autoscaling Group 세부 설정하기</p></a> <a href="/posts/k8s-pod-tz-setting/" class="btn btn-outline-primary" prompt="Newer"><p>K8s Pod에 Time Zone 설정하기</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2093656452178150" crossorigin="anonymous"></script><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/ga0-lee">ga0-lee</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/k8s/">k8s</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/eks/">eks</a> <a class="post-tag" href="/tags/terraform/">terraform</a> <a class="post-tag" href="/tags/iac/">iac</a> <a class="post-tag" href="/tags/nginx/">nginx</a> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/argocd/">ArgoCD</a> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/docker/">docker</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
